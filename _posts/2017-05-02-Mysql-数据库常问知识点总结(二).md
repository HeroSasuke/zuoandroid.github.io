---
layout: post
title: Mysql-数据库常问知识点总结(二)
categories: 数据库相关
description: Mysql-数据库常问知识点总结(二)
keywords: 数据库
---
### 数据库优化方案

- 优化索引、SQL 语句、分析慢查询
- 设计表的时候严格根据数据库的设计范式来设计数据库
- 使用缓存，把经常访问到的数据而且不需要经常变化的数据放在缓存中，能节约磁盘IO
- 优化硬件；采用SSD，使用磁盘队列技术(RAID0,RAID1,RDID5)等；
- 采用MySQL 内部自带的表分区技术，把数据分层不同的文件，能够提高磁盘的读取效率
- 垂直分表；把一些不经常读的数据放在一张表里，节约磁盘I/O
- 主从分离读写；采用主从复制把数据库的读操作和写入操作分离开来
- 分库分表分机器（数据量特别大），主要的的原理就是数据路由
- 选择合适的表引擎，参数上的优化
- 进行架构级别的缓存，静态化和分布式
- 不采用全文索引
- 采用更快的存储方式，例如NoSql存储经常访问的数据

### Mysql集群的优缺点

- 优点：
  - 99.999%的高可用性
  - 快速的自动失效切换
  - 灵活的分布式体系结构，没有单点故障
  - 高吞吐量和低延迟
  - 可扩展性强，支持在线扩容
- 缺点：
  - 存在很多限制，比如：不支持外键
  - 部署、管理、配置很复杂
  - 占用磁盘空间大、内存大
  - 备份和恢复不方便
  - 重启的时候，数据节点将数据load到内存需要很长的时间

### 你用的mysql是哪个引擎，各引擎之间有什么区别？

##### 主要 MyISAM 与 InnoDB 两个引擎，其主要区别如下：

- InnoDB 支持事务，MyISAM 不支持，这一点是非常之重要。事务是一种高级的处理方式，如在一些列增删改中只要哪个出错还可以回滚还原，而 MyISAM就不可以了；
- MyISAM 适合查询以及插入为主的应用，InnoDB 适合频繁修改以及涉及到安全性较高的应用；
- InnoDB 支持外键，MyISAM 不支持；
- MyISAM 是默认引擎，InnoDB 需要指定；
- InnoDB 不支持 FULLTEXT 类型的索引；
- InnoDB 中不保存表的行数，如 ```select count(*) from table ```时，InnoDB；需要扫描一遍整个表来计算有多少行，但是 MyISAM 只要简单的读出保存好的行数即可。注意的是，当 count(*)语句包含 where 条件时 MyISAM 也需要扫描整个表；
- 对于自增长的字段，InnoDB 中必须包含只有该字段的索引，但是在 MyISAM表中可以和其他字段一起建立联合索引；清空整个表时，InnoDB 是一行一行的删除，效率非常慢。MyISAM 则会重建表；
- InnoDB 支持行锁（某些情况下还是锁整表，如 update table set a=1 where  user like '%lee%'

### MongoDB数据库

MongoDB 是一个面向文档的数据库系统。 使用 C++编写， 不支持SQL， 但有自己功能强大的查询语法。
MongoDB 使用 BSON 作为数据存储和传输的格式。 BSON 是一种类似 JSON 的二进制序列化文档， 支持嵌套对象和数组。
MongoDB 很像 MySQL， document 对应 MySQL 的 row， collection对应 MySQL 的 table
**应用场景：**

- 1.网站数据： mongo 非常适合实时的插入， 更新与查询， 并具备网站实时数据存储所需的复制及高度伸缩性。
- 2.缓存： 由于性能很高， mongo 也适合作为信息基础设施的缓存层。 在系统重启之后， 由 mongo 搭建的持久化缓存可以避免下层的数据源过载。
- 3.大尺寸、 低价值的数据： 使用传统的关系数据库存储一些数据时可能会比较贵， 在此之前， 很多程序员往往会选择传统的文件进行存储。
- 4.高伸缩性的场景： mongo 非常适合由数十或者数百台服务器组成的数据库。
- 5.用于对象及 JSON 数据的存储： mongo 的 BSON 数据格式非常适合文档格式化的存储及查询。
- 6.重要数据： mysql， 一般数据： mongodb， 临时数据： memcache
- 7.对于关系数据表而言， mongodb 是提供了一个更快速的视图view； 而对于 PHP 程序而言， mongodb 可以作为一个持久化的数组来使用， 并且这个持久化的数组还可以支持排序、 条件、 限制等功能。
- 8.将 mongodb 代替 mysql 的部分功能， 主要一个思考点就是：把 mongodb 当作 mysql 的一个 view（视图） ， view 是将表数据整合成业务数据的关键。 比如说对原始数据进行报表， 那么就要先把原始数据统计后生成 view， 在对 view 进行查询和报表。

**不适合的场景：**

- a.高度事物性的系统： 例如银行或会计系统。 传统的关系型数据库目前还是更适用于需要大量原子性复杂事务的应用程序。
- b.传统的商业智能应用： 针对特定问题的 BI 数据库会对产生高度优化的查询方式。对于此类应用， 数据仓库可能是更合适的选择。
- c.需要 SQL 的问题
- d.重要数据， 关系数据

**优点:**

- 弱一致性（最终一致） ， 更能保证用户的访问速度文档结构的存储方式， 能够更便捷的获取数内置 GridFS， 高效存储二进制大对象 (比如照片和视频)
- 支持复制集、 主备、 互为主备、 自动分片等特性
- 动态查询
- 全索引支持,扩展到内部对象和内嵌数组

**缺点：** 

- 不支持事务
- MongoDB 占用空间过大
- 维护工具不够成熟
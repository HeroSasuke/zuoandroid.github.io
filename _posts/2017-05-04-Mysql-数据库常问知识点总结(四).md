---
layout: post
title: Mysql-数据库常问知识点总结(四)
categories: 数据库相关
description: Mysql-数据库常问知识点总结(四)
keywords: 数据库
---
### Mysql集群操作步骤

MySQL 群集需要有一组计算机， 每台计算机的角色可能是不一样的。 MySQL 群集中有三种节点： 管理节点、 数据节点和 SQL 节点。 群集中的某计算机可能是某一种节点，也可能是两种或三种节点的集合。这三种节点只是在逻辑上的划分，所以它们不一定和物理计算机是一一对应的关系。
管理节点（也可以称管理服务器） 主要负责管理数据节点和 SQL节点， 还有群集配置文件和群集日志文件。 它监控其他节点的工作状态， 能够启动、 关闭或重启某个节点。 其他节点从管理节点检索配置数据，当数据节点有新事件时就把事件信息发送给管理节点并写入群集日志。
数据节点用于存储数据。
SQL 节点跟一般的 MySQL 服务器是一样的， 我们可以通过它进行 SQL 操作。用的 MysqlServer 已经不能满足群集的要求，配置群集需要使用MySQLCluster。

**MySQLCluster 的配置**

首先找三台电脑， 或者是开三个虚拟机， 管理节点部署在一台机子上， 其他两台每台都部署一个数据节点和一个 SQL 节点。 这里以两台机子举例， 其中一台机器 A（IP 为 192.168.193.90） 部署管理节点、 数据节点和 SQL 节点， 另一台机器 B（IP 为 192.168.193.50）部署数据节点和 SQL 节点。
其实最好不要将管理节点跟数据节点部署到一台机子上，因为如果数据节点宕机会导致管理节点也不可用， 整个 MySQL 群集就都不可用了。 所以一个 MySQL 群集理想情况下至少有三台服务器， 将管理节点单独放到一台服务器上。 暂以两台举例， 只是为了说明三种节点的配置启动方法。将上面下载的安装包解压， 并改文件夹名为 mysql， 因为需要多次在命令行中操作， 所以名字改短后更容易输入。配置管理节点， 配置数据节点， 配置 SQL 节点启动管理节点， 启动数据节点， 启动 SQL 节点

**测试 MySQLCluster： 我们需要测试三种情况：**

- 1.在任一 SQL 节点对数据节点进行操作后， 各数据节点是否能够实现数据同步。 例如， 我们在机器 A 上新创建一个数据库 myDB， 然后再建一个表 student（新建表如下命令： createtable student (id int(2)) engine=ndbcluster） ， 插入若干数据， 接着我们到机器 B上查看是否能看到新的数据库 myDB 和新的表 student 以及插入数据。
- 2.当关闭任一数据节点后， 在所有 SQL 节点中进行操作是否不受其影响。 例如， 我们关闭机器 A 上的数据节点服务， 在两台主机上应该能够继续对数据库进行各种操作。
- 3.关闭某数据节点进行了数据库操作， 然后重新启动， 所有 SQL节点的操作是否正常。

### 怎样解决海量数据的存储和访问造成系统设计瓶颈的问题？ 

- 水平切分数据库： 可以降低单台机器的负载， 同时最大限度的降低了宕机造成的损失； 分库降低了单点机器的负载； 分表， 提高了数据操作的效率，


- 负载均衡策略： 可以降低单台机器的访问负载， 降低宕机的可能性；
- 集群方案：解决了数据库宕机带来的单点数据库不能访问的问题；
- 读写分离策略：最大限度了提高了应用中读取数据的速度和并发量； 

### redis 基本类型、 相关方法 

Redis 支持五种数据类型： string（字符串） 、 hash（哈希）、list（列表） 、 set（集合） 及 zset(sorted set： 有序集合)。

- **一、 String**

  String 是 Redis 最为常用的一种数据类型， String 的数据结构为 key/value 类型， String 可以包含任何数据。
  常用命令: set,get,decr,incr,mget 等

- **二、 Hash**

  Hash 类型可以看成是一个 key/value 都是 String 的 Map 容器。
  常用命令： hget,hset,hgetall 等。

- **三、 List**

  List 用于存储一个有序的字符串列表， 常用的操作是向队列两端添加元素或者获得列表的某一片段。

  常用命令： lpush,rpush,lpop,rpop,lrange 等
- **四、 Set**

  Set 可以理解为一组无序的字符集合， Set 中相同的元素是不会重复出现的， 相同的元素只保留一个。
  常用命令： sadd,spop,smembers,sunion 等

- **五、 Sorted Set（有序集合）**

  有序集合是在集合的基础上为每一个元素关联一个分数， Redis通过分数为集合中的成员进行排序。
  常用命令： zadd,zrange,zrem,zcard 等

